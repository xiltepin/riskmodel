It assumes:

Angular has its own README

Flask (if any) has its own README

This README lives at the root of InsuranceRuleEngine/

You can copy-paste this directly as README.md.

Insurance Rules Engine (Java + Drools)

This module is a Spring Bootâ€“based Insurance Rules Engine that uses Drools to calculate insurance premiums based on risk factors.

It exposes REST endpoints consumed by the Angular frontend and evaluates business rules defined in .drl files.

ğŸ“¦ Tech Stack

Java: 21

Spring Boot: 3.x

Drools: 8.x

Maven: 3.9+

Embedded Tomcat

ğŸ“ Project Structure
InsuranceRuleEngine/
â”œâ”€â”€ src/main/java
â”‚   â””â”€â”€ com/yourcompany
â”‚       â”œâ”€â”€ InsuranceRulesApplication.java
â”‚       â”œâ”€â”€ controller/
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â””â”€â”€ DroolsService.java
â”‚       â””â”€â”€ model/
â”‚           â””â”€â”€ RiskAssessmentResult.java
â”‚
â”œâ”€â”€ src/main/resources
â”‚   â”œâ”€â”€ application.properties
â”‚   â”œâ”€â”€ META-INF/
â”‚   â”‚   â””â”€â”€ kmodule.xml
â”‚   â””â”€â”€ com/yourcompany/insurance/
â”‚       â””â”€â”€ InsuranceRules.drl
â”‚
â”œâ”€â”€ pom.xml
â””â”€â”€ README.md

âœ… Prerequisites

Make sure the following are installed:

Java
java -version


Expected:

openjdk 21.x


If needed:

sudo apt install openjdk-21-jdk

Maven
mvn -version


Expected:

Apache Maven 3.9+


If needed:

sudo apt install maven

âš™ï¸ Drools Configuration
kmodule.xml

Location:

src/main/resources/META-INF/kmodule.xml


Example:

<?xml version="1.0" encoding="UTF-8"?>
<kmodule xmlns="http://www.drools.org/xsd/kmodule">
    <kbase name="insuranceKBase" packages="com.yourcompany.insurance">
        <ksession name="rulesSession"/>
    </kbase>
</kmodule>


âš ï¸ Important
The packages value must match the package declared inside your .drl files.

Rules File (.drl)

Location:

src/main/resources/com/yourcompany/insurance/InsuranceRules.drl


This file contains all Drools business rules.

ğŸ§ª Clean & Build the Project

Always clean before running if rules or config changed:

mvn clean package


If successful, youâ€™ll see:

BUILD SUCCESS

â–¶ï¸ Run the Application (Recommended)
âœ… Run as a packaged JAR (PRODUCTION-LIKE)
java -jar target/insurance-rules-engine-1.0-SNAPSHOT.jar


This is recommended because:

Uses the same classpath as production

Correctly loads Drools rules from BOOT-INF/classes

Avoids classloader issues

âš ï¸ Alternative: Run via Maven (DEV ONLY)
mvn spring-boot:run


Use only for quick development.
Drools behaves more reliably when run as a packaged JAR.

ğŸŒ Application Ports

Spring Boot HTTP: 8080

(Angular connects to this backend)

Example startup log:

ğŸš€ Insurance Rules Engine started on port 8080
ğŸ“‹ Drools rules loaded successfully

ğŸ” Common Commands
Clean everything
mvn clean

Rebuild
mvn clean package

Run tests (if any)
mvn test

ğŸ§  Drools Rule Execution Flow

Angular sends a request

Spring Controller receives input

DroolsService creates a KieSession

Rules are evaluated

Final premium is calculated

Response is returned to frontend

ğŸš¨ Common Issues & Fixes
âŒ Infinite rule execution

Cause:

Missing no-loop true

Rules update facts without guard conditions

Fix:

rule "Example"
no-loop true
when
    finalPremium == 0
then
    setFinalPremium(650);
    update($fact);
end

âŒ Unknown KieSession name

Cause:

Session name mismatch with kmodule.xml

Fix:
Ensure:

kieContainer.newKieSession("rulesSession");


matches:

<ksession name="rulesSession"/>

âŒ Missing MVEL dependency

Error:

MissingDependencyException: add drools-mvel


Fix (pom.xml):

<dependency>
  <groupId>org.drools</groupId>
  <artifactId>drools-mvel</artifactId>
</dependency>

ğŸš« Git Ignore Recommendation

Add to .gitignore:

target/


Never commit build artifacts.

ğŸ“Œ Notes for Developers

Do not put rules under src/main/java

Rules must live under src/main/resources

Always rebuild after modifying .drl files

Prefer field constraints over eval()